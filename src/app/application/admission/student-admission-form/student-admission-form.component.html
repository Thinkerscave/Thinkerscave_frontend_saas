<!-- Main container with enhanced background -->

<div class="min-h-screen bg-gradient-to-br from-slate-50 to-gray-50 flex items-center justify-center p-4 md:p-6">
  <div class="w-full max-w-5xl">
    <p-toast position="top-right"></p-toast>
    <p-card styleClass="shadow-2xl rounded-2xl border-0 overflow-hidden bg-white">
      <!-- Enhanced Header -->
    <ng-template pTemplate="header">
        <div class="header-wrapper">
          <div class="header-left">
            <h1>New Admission Application</h1>
            <p>Academic Year 2025â€“26</p>
          </div>

          <div class="header-right">
            <span>Application ID</span>
            <strong>TC-{{ generateApplicationId() }}</strong>
          </div>
        </div>
      </ng-template>

      <ng-template pTemplate="title">
        <div class="px-6 pt-4">
          <div class="text-gray-600 text-lg">Please fill out the form carefully, following all the steps. 
            <span class="text-red-500 font-bold">*</span> indicates required fields
          </div>
        </div>
      </ng-template>

      <ng-template pTemplate="content">
        <!-- Enhanced Stepper -->
        <div class="px-6 mb-10">
          <p-steps [model]="items" [(activeIndex)]="activeIndex" [readonly]="true">
            <ng-template pTemplate="item" let-item let-index="index">
              <div class="flex items-center cursor-pointer" (click)="goToStep(index)">
                <div class="flex flex-col items-center relative">
                  <div [class]="getStepClass(index)" class="w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg transition-all duration-300 mb-2">
                    {{ index + 1 }}
                  </div>
                  <span class="text-sm font-medium text-gray-700">{{ item.label }}</span>
                  <div class="absolute top-6 left-full w-16 h-0.5 bg-gray-200 -ml-8 hidden md:block" 
                       *ngIf="index < items.length - 1"></div>
                </div>
              </div>
            </ng-template>
          </p-steps>
          
          <!-- Progress Bar -->
          <div class="mt-6">
            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
              <div class="h-full bg-gradient-to-r from-blue-500 to-indigo-600 transition-all duration-500" 
                   [style.width]="(activeIndex + 1) / items.length * 100 + '%'"></div>
            </div>
            <div class="flex justify-between mt-2">
              <span class="text-sm text-gray-600">Progress</span>
              <span class="text-sm font-semibold text-blue-600">{{ ((activeIndex + 1) / items.length * 100).toFixed(0) }}%</span>
            </div>
          </div>
        </div>

        <!-- Form Container -->
        <div class="px-2 md:px-6">
          <form [formGroup]="admissionForm">

            <!-- Step 0: Welcome & Guidelines -->
            <div *ngIf="activeIndex === 0" class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-8 border border-blue-100 shadow-sm">
              <div class="flex items-center gap-4 mb-8">
                <div class="bg-blue-100 p-3 rounded-full">
                  <i class="pi pi-info-circle text-blue-600 text-2xl"></i>
                </div>
                <div>
                  <h3 class="text-3xl font-bold text-gray-900">Welcome to Thinkerscave Admission Portal</h3>
                  <p class="text-gray-600 mt-2">Academic Year 2025-26</p>
                </div>
              </div>
              
              <div class="space-y-8">
                <div>
                  <h4 class="text-xl font-semibold text-gray-900 mb-4">Important Guidelines</h4>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-5 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow">
                      <div class="flex items-start gap-3">
                        <div class="bg-blue-50 p-2 rounded-lg">
                          <i class="pi pi-check-circle text-blue-600"></i>
                        </div>
                        <div>
                          <h5 class="font-semibold text-gray-900 mb-2">Required Documents</h5>
                          <p class="text-gray-600 text-sm">Keep scanned copies ready (PDF/JPG, max 2MB each)</p>
                        </div>
                      </div>
                    </div>
                 
                    <div class="bg-white p-5 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow">
                      <div class="flex items-start gap-3">
                        <div class="bg-blue-50 p-2 rounded-lg">
                          <i class="pi pi-check-circle text-blue-600"></i>
                        </div>
                        <div>
                          <h5 class="font-semibold text-gray-900 mb-2">Mandatory Fields</h5>
                          <p class="text-gray-600 text-sm">All fields marked with <span class="text-red-500 font-bold">*</span> are required</p>
                        </div>
                      </div>
                    </div>
                    <div class="bg-white p-5 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow">
                      <div class="flex items-start gap-3">
                        <div class="bg-blue-50 p-2 rounded-lg">
                          <i class="pi pi-check-circle text-blue-600"></i>
                        </div>
                        <div>
                          <h5 class="font-semibold text-gray-900 mb-2">Save Your ID</h5>
                          <p class="text-gray-600 text-sm">Application ID will be generated after submission</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="bg-blue-100 border-l-4 border-blue-500 p-6 rounded-xl">
                  <div class="flex items-start gap-4">
                    <i class="pi pi-exclamation-triangle text-blue-600 text-2xl mt-1"></i>
                    <div>
                      <p class="text-blue-800 font-semibold text-lg mb-2">Important Note</p>
                      <p class="text-blue-700">Please ensure all information provided is accurate and truthful. 
                        Any discrepancy may lead to cancellation of admission.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 1: Basic Information -->
            <div *ngIf="activeIndex === 1" class="space-y-8">
              <div class="flex items-center gap-4 mb-6">
                <div class="bg-blue-100 p-3 rounded-full">
                  <i class="pi pi-user text-blue-600 text-xl"></i>
                </div>
                <div>
                  <h3 class="text-2xl font-bold text-gray-900">1. Applicant's Basic Information</h3>
                  <p class="text-gray-600">Personal details of the student</p>
                </div>
              </div>

              <div class="form-grid" formGroupName="basicInfo">
                <!-- First Name -->
                <div class="form-field">
                  <label for="first_name" class="form-label">
                    First Name <span class="text-red-500">*</span>
                  </label>
                  <div class="input-wrapper">
                    <i class="pi pi-user input-icon"></i>
                    <input pInputText id="first_name" formControlName="first_name" placeholder="Enter first name" 
                           class="input-control"
                           [class.input-error]="basicInfo.get('first_name')?.invalid && basicInfo.get('first_name')?.touched" />
                  </div>
                  <div class="error-message" *ngIf="basicInfo.get('first_name')?.invalid && basicInfo.get('first_name')?.touched">
                    <i class="pi pi-exclamation-circle"></i>
                    First name is required
                  </div>
                  <div class="hint-text" *ngIf="basicInfo.get('first_name')?.valid">
                    As per birth certificate
                  </div>
                </div>

                <!-- Last Name -->
                <div class="form-field">
                  <label for="last_name" class="form-label">
                    Last Name <span class="text-red-500">*</span>
                  </label>
                  <div class="input-wrapper">
                    <i class="pi pi-user input-icon"></i>
                    <input pInputText id="last_name" formControlName="last_name" placeholder="Enter last name" 
                           class="input-control"
                           [class.input-error]="basicInfo.get('last_name')?.invalid && basicInfo.get('last_name')?.touched" />
                  </div>
                  <div class="error-message" *ngIf="basicInfo.get('last_name')?.invalid && basicInfo.get('last_name')?.touched">
                    <i class="pi pi-exclamation-circle"></i>
                    Last name is required
                  </div>
                </div>

                <!-- Date of Birth -->
                <div class="form-field">
                  <label for="date_of_birth" class="form-label">
                    Date of Birth <span class="text-red-500">*</span>
                  </label>
                  <div class="input-wrapper">
                    <i class="pi pi-calendar input-icon"></i>
                    <p-calendar id="date_of_birth" formControlName="date_of_birth" [showIcon]="false" dateFormat="dd/mm/yy" 
                              placeholder="Select date of birth" 
                              [styleClass]="basicInfo.get('date_of_birth')?.invalid && basicInfo.get('date_of_birth')?.touched ? 'w-full calendar-error' : 'w-full'"></p-calendar>
                  </div>
                  <div class="error-message" *ngIf="basicInfo.get('date_of_birth')?.invalid && basicInfo.get('date_of_birth')?.touched">
                    <i class="pi pi-exclamation-circle"></i>
                    Date of birth is required
                  </div>
                </div>

                <!-- Gender -->
                <div class="form-field">
                  <label for="gender" class="form-label">
                    Gender <span class="text-red-500">*</span>
                  </label>
                  <div class="input-wrapper">
                    <i class="pi pi-venus-mars input-icon"></i>
                    <p-dropdown id="gender" [options]="genderOptions" formControlName="gender" 
                              placeholder="Select gender" optionLabel="name" 
                              [styleClass]="basicInfo.get('gender')?.invalid && basicInfo.get('gender')?.touched ? 'w-full dropdown-error' : 'w-full'"
                              [filter]="true" filterPlaceholder="Search gender...">
                    </p-dropdown>
                  </div>
                  <div class="error-message" *ngIf="basicInfo.get('gender')?.invalid && basicInfo.get('gender')?.touched">
                    <i class="pi pi-exclamation-circle"></i>
                    Please select gender
                  </div>
                </div>

                <!-- Program Selection -->
                <div class="form-field col-span-full">
                  <label for="applying_for_school" class="form-label">
                    Applying for Class/Program <span class="text-red-500">*</span>
                  </label>
                  <div class="input-wrapper">
                    <i class="pi pi-graduation-cap input-icon"></i>
                    <p-dropdown id="applying_for_school" [options]="programOptions" formControlName="applying_for_school" 
                              placeholder="Select program" optionLabel="name" 
                              [styleClass]="basicInfo.get('applying_for_school')?.invalid && basicInfo.get('applying_for_school')?.touched ? 'w-full dropdown-error' : 'w-full'"
                              [filter]="true" filterPlaceholder="Search program...">
                    </p-dropdown>
                  </div>
                  <div class="error-message" *ngIf="basicInfo.get('applying_for_school')?.invalid && basicInfo.get('applying_for_school')?.touched">
                    <i class="pi pi-exclamation-circle"></i>
                    Please select program
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 2: Parent/Guardian Details -->
            <div *ngIf="activeIndex === 2" class="space-y-8">
              <div class="flex items-center gap-4 mb-6">
                <div class="bg-blue-100 p-3 rounded-full">
                  <i class="pi pi-users text-blue-600 text-xl"></i>
                </div>
                <div>
                  <h3 class="text-2xl font-bold text-gray-900">2. Parent/Guardian Details</h3>
                  <p class="text-gray-600">Contact information of parents or guardians</p>
                </div>
              </div>

              <div class="form-grid" formGroupName="parentDetails">
                <!-- Parent's Name -->
                <div class="form-field">
                  <label for="parent_name" class="form-label">
                    Parent's Name <span class="text-red-500">*</span>
                  </label>
                  <div class="input-wrapper">
                    <i class="pi pi-user input-icon"></i>
                    <input pInputText id="parent_name" formControlName="parent_name" placeholder="Enter parent's full name" 
                           class="input-control"
                           [class.input-error]="parentDetails.get('parent_name')?.invalid && parentDetails.get('parent_name')?.touched" />
                  </div>
                  <div class="error-message" *ngIf="parentDetails.get('parent_name')?.invalid && parentDetails.get('parent_name')?.touched">
                    <i class="pi pi-exclamation-circle"></i>
                    Parent's name is required
                  </div>
                </div>

                <!-- Guardian's Name -->
                <div class="form-field">
                  <label for="guardian_name" class="form-label">
                    Guardian's Name <span class="text-gray-400">(Optional)</span>
                  </label>
                  <div class="input-wrapper">
                    <i class="pi pi-user input-icon"></i>
                    <input pInputText id="guardian_name" formControlName="guardian_name" 
                           placeholder="Enter guardian's name if different" class="input-control" />
                  </div>
                  <div class="hint-text">
                    If applicable
                  </div>
                </div>

                <!-- Email -->
                <div class="form-field">
                  <label for="email" class="form-label">
                    Contact Email <span class="text-red-500">*</span>
                  </label>
                  <div class="input-wrapper">
                    <i class="pi pi-envelope input-icon"></i>
                    <input pInputText id="email" type="email" formControlName="email" 
                           placeholder="parent@example.com" class="input-control"
                           [class.input-error]="parentDetails.get('email')?.invalid && parentDetails.get('email')?.touched" />
                  </div>
                  <div class="error-message" *ngIf="parentDetails.get('email')?.errors?.['required'] && parentDetails.get('email')?.touched">
                    <i class="pi pi-exclamation-circle"></i>
                    Email is required
                  </div>
                  <div class="error-message" *ngIf="parentDetails.get('email')?.errors?.['email'] && parentDetails.get('email')?.touched">
                    <i class="pi pi-exclamation-circle"></i>
                    Please enter a valid email address
                  </div>
                </div>

                <!-- Phone Number -->
                <div class="form-field">
                  <label for="contact_number" class="form-label">
                    Contact Phone <span class="text-red-500">*</span>
                  </label>
                  <div class="input-wrapper">
                    <i class="pi pi-phone input-icon"></i>
                    <input pInputText id="contact_number" type="tel" formControlName="contact_number" 
                           placeholder="+91 9876543210" class="input-control"
                           [class.input-error]="parentDetails.get('contact_number')?.invalid && parentDetails.get('contact_number')?.touched" />
                  </div>
                  <div class="error-message" *ngIf="parentDetails.get('contact_number')?.errors?.['required'] && parentDetails.get('contact_number')?.touched">
                    <i class="pi pi-exclamation-circle"></i>
                    Phone number is required
                  </div>
                  <div class="error-message" *ngIf="parentDetails.get('contact_number')?.errors?.['pattern'] && parentDetails.get('contact_number')?.touched">
                    <i class="pi pi-exclamation-circle"></i>
                    Please enter 10-15 digits only
                  </div>
                  <div class="hint-text">
                    Include country code if international
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 3: Address & Emergency Contact -->
            <div *ngIf="activeIndex === 3" class="space-y-8">
              <div class="flex items-center gap-4 mb-6">
                <div class="bg-blue-100 p-3 rounded-full">
                  <i class="pi pi-home text-blue-600 text-xl"></i>
                </div>
                <div>
                  <h3 class="text-2xl font-bold text-gray-900">3. Address & Emergency Contact</h3>
                  <p class="text-gray-600">Residential address and emergency contact details</p>
                </div>
              </div>

              <div class="space-y-8">
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-2xl border border-blue-100">
                  <h4 class="text-xl font-semibold text-gray-900 mb-6 flex items-center gap-3">
                    <i class="pi pi-map-marker text-blue-600"></i>
                    Residential Address
                  </h4>
                  <div class="form-grid" formGroupName="address">
                    <div class="form-field col-span-full">
                      <label class="form-label">
                        Street Address <span class="text-red-500">*</span>
                      </label>
                      <div class="input-wrapper">
                        <i class="pi pi-map input-icon"></i>
                        <textarea pInputTextarea formControlName="street" rows="3" 
                                  placeholder="Enter complete street address"
                                  class="input-control resize-none"
                                  [class.input-error]="address.get('street')?.invalid && address.get('street')?.touched"></textarea>
                      </div>
                      <div class="error-message" *ngIf="address.get('street')?.invalid && address.get('street')?.touched">
                        <i class="pi pi-exclamation-circle"></i>
                        Street address is required
                      </div>
                    </div>

                    <div class="form-field">
                      <label for="city" class="form-label">
                        City <span class="text-red-500">*</span>
                      </label>
                      <div class="input-wrapper">
                        <i class="pi pi-building input-icon"></i>
                        <input pInputText id="city" formControlName="city" placeholder="Enter city" 
                               class="input-control"
                               [class.input-error]="address.get('city')?.invalid && address.get('city')?.touched" />
                      </div>
                      <div class="error-message" *ngIf="address.get('city')?.invalid && address.get('city')?.touched">
                        <i class="pi pi-exclamation-circle"></i>
                        City is required
                      </div>
                    </div>

                    <div class="form-field">
                      <label for="state" class="form-label">
                        State <span class="text-red-500">*</span>
                      </label>
                      <div class="input-wrapper">
                        <i class="pi pi-globe input-icon"></i>
                        <input pInputText id="state" formControlName="state" placeholder="Enter state" 
                               class="input-control"
                               [class.input-error]="address.get('state')?.invalid && address.get('state')?.touched" />
                      </div>
                      <div class="error-message" *ngIf="address.get('state')?.invalid && address.get('state')?.touched">
                        <i class="pi pi-exclamation-circle"></i>
                        State is required
                      </div>
                    </div>

                    <div class="form-field">
                      <label for="pincode" class="form-label">
                        Pincode <span class="text-red-500">*</span>
                      </label>
                      <div class="input-wrapper">
                        <i class="pi pi-inbox input-icon"></i>
                        <input pInputText id="pincode" formControlName="pincode" placeholder="110001" 
                               class="input-control"
                               [class.input-error]="address.get('pincode')?.invalid && address.get('pincode')?.touched" />
                      </div>
                      <div class="error-message" *ngIf="address.get('pincode')?.errors?.['required'] && address.get('pincode')?.touched">
                        <i class="pi pi-exclamation-circle"></i>
                        Pincode is required
                      </div>
                      <div class="error-message" *ngIf="address.get('pincode')?.errors?.['pattern'] && address.get('pincode')?.touched">
                        <i class="pi pi-exclamation-circle"></i>
                        Please enter 6 digits only
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Emergency Contact -->
                <div class="bg-gradient-to-r from-red-50 to-orange-50 p-6 rounded-2xl border border-red-100">
                  <h4 class="text-xl font-semibold text-gray-900 mb-6 flex items-center gap-3">
                    <i class="pi pi-shield text-red-600"></i>
                    Emergency Contact Information
                  </h4>
                  <div class="form-grid" formGroupName="emergencyContact">
                    <div class="form-field">
                      <label for="emergency_contact_name" class="form-label">
                        Contact Person <span class="text-red-500">*</span>
                      </label>
                      <div class="input-wrapper">
                        <i class="pi pi-user input-icon"></i>
                        <input pInputText id="emergency_contact_name" formControlName="name" 
                               placeholder="Relative's full name" class="input-control"
                               [class.input-error]="emergencyContact.get('name')?.invalid && emergencyContact.get('name')?.touched" />
                      </div>
                      <div class="error-message" *ngIf="emergencyContact.get('name')?.invalid && emergencyContact.get('name')?.touched">
                        <i class="pi pi-exclamation-circle"></i>
                        Emergency contact name is required
                      </div>
                      <div class="hint-text">
                        Person to contact in case of emergency
                      </div>
                    </div>

                    <div class="form-field">
                      <label for="emergency_contact_number" class="form-label">
                        Contact Number <span class="text-red-500">*</span>
                      </label>
                      <div class="input-wrapper">
                        <i class="pi pi-phone input-icon"></i>
                        <input pInputText id="emergency_contact_number" formControlName="number" 
                               placeholder="+91 9876543211" class="input-control"
                               [class.input-error]="emergencyContact.get('number')?.invalid && emergencyContact.get('number')?.touched" />
                      </div>
                      <div class="error-message" *ngIf="emergencyContact.get('number')?.errors?.['required'] && emergencyContact.get('number')?.touched">
                        <i class="pi pi-exclamation-circle"></i>
                        Emergency contact number is required
                      </div>
                      <div class="error-message" *ngIf="emergencyContact.get('number')?.errors?.['pattern'] && emergencyContact.get('number')?.touched">
                        <i class="pi pi-exclamation-circle"></i>
                        Please enter 10-15 digits only
                      </div>
                      <div class="hint-text">
                        24/7 accessible number
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 4: Document Upload -->
            <div *ngIf="activeIndex === 4" class="space-y-8">
              <div class="flex items-center gap-4 mb-6">
                <div class="bg-blue-100 p-3 rounded-full">
                  <i class="pi pi-file text-blue-600 text-xl"></i>
                </div>
                <div>
                  <h3 class="text-2xl font-bold text-gray-900">4. Upload Required Documents</h3>
                  <p class="text-gray-600">Upload scanned copies of all required documents</p>
                </div>
              </div>

              <div class="mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-xl">
                <div class="flex items-start gap-3">
                  <i class="pi pi-info-circle text-yellow-600 text-xl mt-1"></i>
                  <div>
                    <p class="text-yellow-800 font-medium">Upload files in PDF, JPG, or JPEG format (max 2MB each).</p>
                    <p class="text-yellow-700 text-sm mt-1"><span class="text-red-500 font-bold">*</span> indicates required documents</p>
                  </div>
                </div>
              </div>

              <div formArrayName="documents">
                <div *ngFor="let doc of documents.controls; let i=index" [formGroupName]="i" 
                     class="mb-6 p-6 border border-gray-200 rounded-xl bg-gradient-to-r from-gray-50 to-white hover:shadow-md transition-shadow">
                  <div class="flex flex-col md:flex-row md:items-center gap-4 mb-4">
                    <div class="flex-grow form-field">
                      <label class="form-label">
                        Document Name <span class="text-red-500">*</span>
                      </label>
                      <div class="input-wrapper">
                        <i class="pi pi-file-edit input-icon"></i>
                        <input pInputText formControlName="fileName" placeholder="e.g., Birth Certificate" 
                               class="input-control"
                               [class.input-error]="doc.get('fileName')?.invalid && doc.get('fileName')?.touched" />
                      </div>
                      <div class="error-message" *ngIf="doc.get('fileName')?.invalid && doc.get('fileName')?.touched">
                        <i class="pi pi-exclamation-circle"></i>
                        Document name is required
                      </div>
                    </div>
                    
                    <div class="flex flex-col md:flex-row gap-3 mt-2 md:mt-0">
                      <div class="form-field">
                        <label class="form-label opacity-0 md:opacity-100">Upload</label>
                        <input type="file" [id]="'file-upload-' + i" (change)="onFileSelect($event, i)" 
                               class="hidden" accept="application/pdf,image/jpeg,image/jpg">
                        <p-button label="Choose File" icon="pi pi-upload" styleClass="p-button-outlined"
                                 (click)="triggerFileUpload(i)"></p-button>
                      </div>
                      
                      <div class="form-field">
                        <label class="form-label opacity-0 md:opacity-100">Remove</label>
                        <p-button icon="pi pi-trash" styleClass="p-button-danger p-button-outlined" 
                                 (click)="removeDocument(i)" [disabled]="documents.length === 1"></p-button>
                      </div>
                    </div>
                  </div>
                  
                  <div *ngIf="doc.get('file')?.value" class="mt-4 p-4 bg-green-50 border border-green-200 rounded-lg">
                    <div class="flex items-center justify-between">
                      <div class="flex items-center gap-3">
                        <i class="pi pi-check-circle text-green-600 text-xl"></i>
                        <div>
                          <p class="text-green-800 font-medium">File uploaded successfully</p>
                          <p class="text-green-700 text-sm">{{ doc.get('file')?.value?.name }}</p>
                          <p class="text-green-600 text-xs mt-1">
                            Size: {{ (doc.get('file')?.value?.size / 1024 / 1024).toFixed(2) }} MB
                          </p>
                        </div>
                      </div>
                      <p-button icon="pi pi-eye" styleClass="p-button-text p-button-sm" 
                               (click)="previewDocument(doc.get('file')?.value)"></p-button>
                    </div>
                  </div>
                  
                  <div class="error-message mt-2" *ngIf="doc.get('file')?.invalid && doc.get('file')?.touched">
                    <i class="pi pi-exclamation-circle"></i>
                    Please upload a file for this document
                  </div>
                </div>
              </div>
              
              <div class="flex justify-between items-center mt-6">
                <p-button label="Add Another Document" icon="pi pi-plus" (click)="addDocument()" 
                         styleClass="p-button-text"></p-button>
                <div class="text-sm text-gray-500">
                  Total uploaded: {{ getUploadedDocumentsCount() }} / {{ documents.length }}
                </div>
              </div>
            </div>

            <!-- Step 5: Review and Submit -->
            <div *ngIf="activeIndex === 5" class="space-y-8">
              <div class="flex items-center gap-4 mb-6">
                <div class="bg-blue-100 p-3 rounded-full">
                  <i class="pi pi-eye text-blue-600 text-xl"></i>
                </div>
                <div>
                  <h3 class="text-2xl font-bold text-gray-900">5. Review Your Application</h3>
                  <p class="text-gray-600">Verify all information before proceeding to payment</p>
                </div>
              </div>

              <div class="mb-6 p-6 bg-blue-50 border border-blue-200 rounded-2xl">
                <div class="flex items-center gap-4">
                  <i class="pi pi-info-circle text-blue-600 text-2xl"></i>
                  <div>
                    <p class="text-blue-800 font-semibold text-lg">Important Notice</p>
                    <p class="text-blue-700">Please review all the information below carefully. Once you proceed to payment, 
                      you cannot modify the application details.</p>
                  </div>
                </div>
              </div>

              <div class="space-y-8">
                <div *ngFor="let section of reviewSections; let sectionIndex = index" 
                     class="bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm">
                  <div class="bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b">
                    <h4 class="text-xl font-semibold text-gray-900">{{ section.title }}</h4>
                  </div>
                  <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                      <div *ngFor="let field of section.fields" 
                           class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                        <div class="flex items-center justify-between mb-2">
                          <span class="font-semibold text-gray-700">{{ field.label }}:</span>
                          <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-text p-button-sm"
                                 (click)="editSection(sectionIndex, field)"></button>
                        </div>
                        <p class="text-gray-900 font-medium">{{ field.value || 'Not provided' }}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Review Confirmation -->
              <div class="mt-10 p-6 border-2 border-blue-200 rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50">
                <div class="flex items-start gap-4">
                  <p-checkbox [(ngModel)]="reviewConfirmed" [binary]="true" inputId="reviewConfirmation" 
                            [ngModelOptions]="{standalone: true}"
                            [style]="{'border-color': !reviewConfirmed && reviewFormTouched ? '#ef4444' : ''}"></p-checkbox>
                  <div class="flex-1">
                    <label for="reviewConfirmation" class="form-label text-lg">
                      Review Confirmation <span class="text-red-500">*</span>
                    </label>
                    <p class="text-gray-700 mt-2">I have thoroughly reviewed all the information provided above and confirm that it is accurate and complete. 
                      I understand that any false information may lead to cancellation of admission.</p>
                    <div class="error-message mt-2" *ngIf="!reviewConfirmed && reviewFormTouched">
                      <i class="pi pi-exclamation-circle"></i>
                      You must confirm your review 
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Step 6: Payment -->
          
          </form>
        </div>
      </ng-template>

      <ng-template pTemplate="footer">
        <div class="px-6">
          <!-- Validation Summary -->
          <div class="mb-6 p-4 border rounded-lg" 
               [class.border-green-200]="isCurrentStepValid()" 
               [class.border-red-200]="!isCurrentStepValid() && activeIndex > 0 && activeIndex < 6"
               [class.bg-green-50]="isCurrentStepValid()" 
               [class.bg-red-50]="!isCurrentStepValid() && activeIndex > 0 && activeIndex < 6">
            <div class="flex items-center gap-3">
              <i [class]="getStepValidationIcon()" [class.text-green-600]="isCurrentStepValid()" [class.text-red-600]="!isCurrentStepValid() && activeIndex > 0 && activeIndex < 6"></i>
              <div>
                <p [class.text-green-800]="isCurrentStepValid()" [class.text-red-800]="!isCurrentStepValid() && activeIndex > 0 && activeIndex < 6">
                  {{ getStepValidationMessage() }}
                </p>
              </div>
            </div>
          </div>

          <!-- Navigation Buttons -->
          <div class="flex flex-col md:flex-row justify-between items-center gap-4 pt-6 border-t border-gray-200">
            <!-- Left Buttons -->
            <div class="flex flex-col md:flex-row gap-3 w-full md:w-auto">
              <p-button label="Back" icon="pi pi-arrow-left" (click)="prevStep()" [disabled]="activeIndex === 0" 
                        styleClass="p-button-secondary p-button-outlined w-full md:w-auto"></p-button>
              
              <p-button *ngIf="activeIndex > 0 && activeIndex < items.length - 1" 
                        label="Save as Draft" 
                        icon="pi pi-save" 
                        (click)="saveAsDraft()" 
                        styleClass="p-button-info p-button-outlined w-full md:w-auto"></p-button>
            </div>
            
            <!-- Right Buttons -->
            <div class="flex flex-col md:flex-row gap-3 w-full md:w-auto">
              <p-button *ngIf="activeIndex < items.length - 1" 
                        [label]="getNextButtonLabel()" 
                        [icon]="getNextButtonIcon()" 
                        iconPos="right" 
                        (click)="nextStep()"
                        [disabled]="activeIndex > 0 && activeIndex < 6 && !isCurrentStepValid()"
                        styleClass="bg-gradient-to-r from-blue-600 to-indigo-600 border-0 hover:from-blue-700 hover:to-indigo-700 w-full md:w-auto"></p-button>
              
              <p-button *ngIf="activeIndex === items.length - 1" 
                        label="Submit Application" 
                        icon="pi pi-check" 
                        (click)="submitApplication()" 
                         
                        styleClass="p-button-success bg-gradient-to-r from-green-600 to-emerald-600 border-0 hover:from-green-700 hover:to-emerald-700 w-full md:w-auto"></p-button>
            </div>
          </div>
          
          <!-- Step Indicator -->
          <div class="mt-6 text-center">
            <p class="text-sm text-gray-500">
              Step <span class="font-semibold text-blue-600">{{ activeIndex + 1 }}</span> of 
              <span class="font-semibold text-gray-700">{{ items.length }}</span>
            </p>
          </div>
        </div>
      </ng-template>
    </p-card>
  </div>
</div>