<p-tabs [(value)]="activeTab">
  <p-tablist>
    <p-tab value="0">Add</p-tab>
    <p-tab value="1">View</p-tab>
  </p-tablist>

  <p-tabpanels>
    <p-tabpanel value="0">
      <div class="card form-shell">
        <div class="form-header">
          <div>
            <p class="eyebrow">Hostel Â· Night shift</p>
            <h3>Log Hostel Attendance</h3>
            <p>Track residents, room status, late returns and night-outs.</p>
          </div>
          <div class="form-meta">
            <span class="label">Residents logged</span>
            <strong>{{ records.length }}</strong>
          </div>
        </div>

        <form [formGroup]="attendanceForm" (ngSubmit)="onSubmit()">
          <div class="form-grid two-col">
            <div class="form-field">
              <label>Resident Name</label>
              <input pInputText type="text" formControlName="residentName" placeholder="Enter resident name" />
            </div>

            <div class="form-field">
              <label>Room Number</label>
              <input pInputText type="text" formControlName="roomNumber" placeholder="B203" />
            </div>

            <div class="form-field">
              <label>Date</label>
              <input pInputText type="date" formControlName="date" />
            </div>

            <div class="form-field">
              <label>Status</label>
              <p-dropdown [options]="statusOptions" formControlName="status" placeholder="Select status">
              </p-dropdown>
            </div>

            <div class="form-field span-two">
              <label>Remarks</label>
              <textarea pInputTextarea formControlName="remarks" rows="3" placeholder="Gate notes, approvals, etc."></textarea>
            </div>
          </div>

          <div class="form-actions">
            <ng-container *ngIf="!isEditing; else hostelUpdateButtons">
              <p-button label="Add Entry" icon="pi pi-check" type="submit" [disabled]="attendanceForm.invalid"></p-button>
            </ng-container>
            <ng-template #hostelUpdateButtons>
              <p-button label="Update Entry" icon="pi pi-save" type="button" (click)="onUpdateRecord()"
                [disabled]="attendanceForm.invalid"></p-button>
              <p-button label="Cancel" icon="pi pi-times" class="p-button-text" type="button" (click)="resetForm()">
              </p-button>
            </ng-template>
          </div>
        </form>
      </div>
    </p-tabpanel>

    <p-tabpanel value="1">
      <div class="card">
        <div class="table-toolbar">
          <h5>Hostel Attendance Records</h5>
          <span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input pInputText type="text" placeholder="Search..." [value]="globalFilterValue"
              (input)="onGlobalFilter(dt, $event)" />
          </span>
        </div>

        <p-table #dt [value]="records" dataKey="id"
          [globalFilterFields]="['residentName','roomNumber','date','status','remarks']" styleClass="p-datatable-striped"
          [paginator]="true" [rows]="5" [rowsPerPageOptions]="[5,10,20]" sortMode="multiple">
          <ng-template pTemplate="header">
            <tr>
              <th pSortableColumn="residentName">
                Resident
                <p-sortIcon field="residentName"></p-sortIcon>
              </th>
              <th pSortableColumn="roomNumber">
                Room
                <p-sortIcon field="roomNumber"></p-sortIcon>
              </th>
              <th pSortableColumn="date">
                Date
                <p-sortIcon field="date"></p-sortIcon>
              </th>
              <th pSortableColumn="status">
                Status
                <p-sortIcon field="status"></p-sortIcon>
              </th>
              <th>Remarks</th>
              <th class="text-center">Actions</th>
            </tr>
          </ng-template>

          <ng-template pTemplate="body" let-record>
            <tr>
              <td>{{ record.residentName }}</td>
              <td>{{ record.roomNumber }}</td>
              <td>{{ record.date }}</td>
              <td>
                <span class="status-chip status-{{ record.status | lowercase }}">{{ record.status }}</span>
              </td>
              <td>{{ record.remarks }}</td>
              <td class="text-center">
                <button pButton icon="pi pi-pencil" class="p-button-rounded p-button-text p-button-primary"
                  pTooltip="Edit" (click)="onEditRecord(record)"></button>
                <button pButton icon="pi pi-trash" class="p-button-rounded p-button-text p-button-danger"
                  pTooltip="Delete" (click)="onDeleteRecord(record)"></button>
              </td>
            </tr>
          </ng-template>

          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="6" class="text-center">No hostel attendance data found.</td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </p-tabpanel>
  </p-tabpanels>
</p-tabs>
