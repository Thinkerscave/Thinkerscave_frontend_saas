<div class="card p-4">
    <div class="flex justify-content-between">
        <h2>{{ isEditMode ? 'Edit' : 'Create' }} Syllabus</h2>
        <button pButton label="Save" (click)="onSubmit()"></button>
    </div>
    <form [formGroup]="syllabusForm">
        <div class="grid mb-4">
            <div class="col-12 md:col-6 field">
                <label>Code</label>
                <input pInputText formControlName="syllabusCode" class="w-full" />
            </div>
            <div class="col-12 md:col-6 field">
                <label>Version</label>
                <input pInputText formControlName="version" [readonly]="true" class="w-full bg-gray-100" />
            </div>
        </div>

        <h3>Chapters</h3>
        <p-accordion>
            <div formArrayName="chapters">
                <p-accordionTab *ngFor="let chapter of chapters.controls; let i=index" [header]="'Chapter ' + (i+1)"
                    [selected]="true">
                    <div [formGroupName]="i" class="p-3">
                        <div class="field">
                            <label>Chapter Name</label>
                            <input pInputText formControlName="name" class="w-full" placeholder="Ex: Derivatives" />
                        </div>

                        <div class="ml-4 mt-3">
                            <h4>Topics</h4>
                            <div formArrayName="topics">
                                <div *ngFor="let topic of getTopics(i).controls; let j=index" [formGroupName]="j"
                                    class="flex gap-2 mb-2">
                                    <input pInputText formControlName="name" placeholder="Topic Name"
                                        class="flex-grow-1" />
                                    <input pInputText type="number" formControlName="estimatedMinutes"
                                        placeholder="Mins" style="width: 100px" />
                                    <button pButton icon="pi pi-trash" class="p-button-danger p-button-text"
                                        (click)="getTopics(i).removeAt(j)"></button>
                                </div>
                            </div>
                            <button pButton label="Add Topic" icon="pi pi-plus"
                                class="p-button-sm p-button-outlined mt-2" (click)="addTopic(i)"></button>
                        </div>
                    </div>
                </p-accordionTab>
            </div>
        </p-accordion>
        <button pButton label="Add Chapter" icon="pi pi-plus" class="mt-3 w-full" (click)="addChapter()"></button>
    </form>
</div>